{
    "contents" : "if (require(survey) == FALSE) \n  {\n    install.packages(\"survey\")\n    library(survey)\n  }\nif(require(sas7bdat) == FALSE)\n{\n  install.packages(\"sas7bdat\")\n  library(sas7bdat)\n}\n\nif (!file.exists(\"chs2011.RData\")) {\n  # import SAS data set (not necessary if R object is already saved)\n  chs2011 <- read.sas7bdat(\"chs2011_public.sas7bdat\")\n  # Save as R data object (not necessary if R object is already saved)\n  save(chs2011,file=\"chs2011.RData\")\n}\n\n# Load R object \nload(\"chs2011.RData\")\n#change NaN's to NA\nchs2011[is.na(chs2011)] <- NA\n\n\n# This section has issues -- I have to manually run some of the lines 2-3 times in order\n# for it to encode properly. I changed the order, first coding the zeros and NA's,\n# then coding 1's on top of them for sexualid, msm, and wsw.\n# For some reason, if I don't include !is.na in the criteria for these,\n# it ends up completely confused.\n\nchs2011$sexualid[is.na(chs2011$sexualid)] <- NA\nchs2011$lgb[chs2011$sexualid == 1 & !is.na(chs2011$sexualid)] <- 0\nchs2011$lgb[chs2011$sexualid == 2 & !is.na(chs2011$sexualid)] <- 1\nchs2011$lgb[chs2011$sexualid == 3 & !is.na(chs2011$sexualid)] <- 1\nchs2011$lgb[chs2011$msm == 1 & !is.na(chs2011$msm)] <- 1\nchs2011$lgb[chs2011$wsw == 1 & !is.na(chs2011$wsw)] <- 1\n\nchs2011$lgb <- factor(chs2011$lgb)\n\n#recode didntgetcare 0,1,NA\nchs2011$nocare <- factor(chs2011$didntgetcare11-1)\n\n#recode povgroup3 1=0,2=1,3=2,4=NA\nchs2011$povrec <- factor(chs2011$povgroup3-1)\nchs2011$povrec[chs2011$povrec==3] <- NA\n\n#recode generalhealth\nchs2011$healthrec[chs2011$generalhealth < 4 & !is.na(chs2011$generalhealth)] <- 0\nchs2011$healthrec[chs2011$generalhealth >= 4 & !is.na(chs2011$generalhealth)] <- 1\nchs2011$healthrec <- factor(chs2011$healthrec)\n\n# MENTAL HEALTH VARIABLES\n# recode kessler variables\nchs2011$kesslerbin[chs2011$k6_12m >= 13] <- 0\nchs2011$kesslerbin[chs2011$k6_12m < 13] <- 1\nchs2011$kesslerbin <- factor(chs2011$kesslerbin)\n\n#create binary variable for received MH treatment past yr\nchs2011$mhtbin[chs2011$pastyrmht == 1 & !is.na(chs2011$pastyrmht)] <- 0\nchs2011$mhtbin[chs2011$pastyrmht >= 2 & !is.na(chs2011$pastyrmht)] <- 1\nchs2011$mhtbin <- factor(chs2011$mhtbin)\n\n#create composite variable for kesslerbin >= 13 but no MH trtmt\nchs2011$nohm[is.na(chs2011$mhtbin)] <- 0\nchs2011$nohm[chs2011$kesslerbin == 0 & chs2011$mhtbin == 0 & !is.na(chs2011$mhtbin)] <- 1\nchs2011$nohm <- factor(chs2011$nohm)\n# reorder factor variables to specify reference values for regression\n\n\n\n# encode survey design factors\nchsdesign <- svydesign(id=~1,strata=strata,weights=\n                         wt12_dual,variables=chs2011,data=chs2011)\n# crude regressions for physical health\nnocare_lgb <- svyglm(nocare~lgb,design=chsdesign,family=quasibinomial)\nnocare_insured <- svyglm(nocare~insured,design=chsdesign,family=quasibinomial)\nnocare_povrec <- svyglm(nocare~povrec,design=chsdesign,family=quasibinomial)\nnocare_newrace <- svyglm(nocare~newrace,design=chsdesign,family=quasibinomial)\nnocare_sex <- svyglm(nocare~sex,design=chsdesign,family=quasibinomial)\n\n  ## regression on healthrec with 1 and 0 as reference variable\n  chs2011$healthrec <- factor(healthrec, levels=c(\"0\",\"1\"))\n  nocare_healthrec_ref0 <- svyglm(nocare~healthrec,design=chsdesign,family=quasibinomial)\n  chs2011$healthrec <- factor(healthrec, levels=c(\"1\",\"0\"))\n  nocare_healthrec1_ref1 <- svyglm(nocare~healthrec,design=chsdesign,family=quasibinomial)\n\n  ## regression on agegroup with 1 and 4 as reference variables\n  chs2011$agegroup <- factor(agegroup, levels=c(\"1\",\"2\",\"3\",\"4\"))\n  nocare_agegroup_ref1 <- svyglm(nocare~agegroup,design=chsdesign,family=quasibinomial)\n  chs2011$agegroup <- factor(agegroup, levels=c(\"4\",\"3\",\"2\",\"1\"))\n  nocare_agegroup_ref4 <- svyglm(nocare~agegroup,design=chsdesign,family=quasibinomial)\n  \n  ## regression on borough with \"Manhattan\" as reference variable (I think 3 is Manhattan)\n  chs2011$borough <- factor(borough, levels=c(\"3\",\"1\",\"2\",\"4\",\"5\"))\n  nocare_borough <- svyglm(nocare~borough,design=chsdesign,family=quasibinomial)\n\n\ndetach(chs2011)",
    "created" : 1442602773638.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3944709733",
    "id" : "1FA9B076",
    "lastKnownWriteTime" : 1442608810,
    "path" : "C:/Users/arenson/Google Drive/NYC CHS Healtcare Access Project/R/chs-4yr-wtd-data/FinnCode (1).R",
    "project_path" : "FinnCode (1).R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}